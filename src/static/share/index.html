<!DOCTYPE html>
<html>
	<head>
		<title>Tim Gabrkowski | MusicServer</title>
		<link
			rel="stylesheet"
			href="https://tim-gabrikowski.github.io/TimWizardUI/versions/v1.2.0/style.css"
			type="text/css"
		/>
		<script
			type="text/javascript"
			src="https://tim-gabrikowski.github.io/TimWizardUI/versions/v1.2.0/script.js"
		></script>
		<link
			rel="stylesheet"
			href="https://tim-gabrikowski.github.io/TimWizardUI/plugins/audioplayer/style.css"
			type="text/css"
		/>
		<script
			type="text/javascript"
			src="https://tim-gabrikowski.github.io/TimWizardUI/plugins/audioplayer/script.js"
		></script>
	</head>
	<body></body>
	<script>
		const songS = "--DATA--"
			.replace(/&sq;/g, "'")
			.replace(/&dq;/g, '"')
			.replace(/&bt;/g, "`");

		const song = JSON.parse(songS);
		console.log(song);

		let streamUrl = song.Locations.find((l) => l.type == "stream").path;

		const mainPage = page_create({
			id: "main_page",
			title: song.title,
			center: true,
			style: {
				width: "500px",
			},
			layout: "column",
			children: [
				text_create({ text: song.Artist.name }),
				layout_create({
					color: "red",
					border: true,
					style: { width: "500px", margin: "10px" },
					children: [
						image_create({
							src: song.thumbnail,
							style: { width: "500px" },
						}),
					],
				}),
				layout_create({
					color: "red",
					border: true,
					style: {
						width: "500px",
						margin: "10px",
						alignItems: "center",
						justifyContent: "space-around",
					},
					type: "row",
					children: [
						image_create({
							id: "w_youtube",
							src: "../../static/youtube.svg",
							alt: "youtube logo",
							style: {
								height: "30px",
								margin: "30px",
							},
						}),
						button_create({
							label: "Auf Youtube ansehen",
							color: "red",
							onclick: () => {
								let youtubeUrl = song.Locations.find(
									(l) => l.type == "youtube"
								).path;
								window.location = youtubeUrl;
							},
						}),
					],
				}),
				audioplayer_create({
					id: "audioplayer",
					className: "audioplayer",
					color: "red",
					src: streamUrl || "",
					songData: {
						title: song.title,
						artist: song.Artist.name,
					},
					onended: () => {
						console.log("playback ended!");
					},
				}),
			],
		});
		mainPage.show();
	</script>
</html>
